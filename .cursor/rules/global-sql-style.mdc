---
description: |
  SQL/DDL style for identifiers, typography, DDL, DML, views, procedures.
  Apply when creating or editing .sql or when suggesting schema/DML.
globs: ["**/*.sql", "sharepoint/infra/schema/**"]
alwaysApply: false
---

# SQL style (AI)

- **Write SQL only in .sql files.** Do not embed SQL in TypeScript/JavaScript;
  keep all SQL in `.sql` files and load via `loadSql(baseUrl, filename)` from
  `sharepoint/infra/sql-loader.ts`. DDL: `sharepoint/infra/schema/*.sql`. DML:
  `application/<module>/sql/*.sql`.

Short checklist for SQL/DDL. **Full text**: `sharepoint/context/RULESET.md` §U. DDL file naming: `sharepoint/context/config/MANUAL.md` (Schema DDL file naming).

## 1. Names and identifiers

- Use only letters, digits, and underscore; length limit (e.g. 30). No quoted identifiers (double-quoted).
- **Case**: Reserved words UPPERCASE; tables, views, columns, variables lowercase snake_case.
- No `tbl_`, `vw_`, or other table/view prefixes.
- Use standard suffixes: `_id`, `_date`, `_nbr`, `_name`, `_code`, `_status`. No bare `id`, `date`, or `amount`; use qualified names (e.g. `user_id`, `created_at`).
- Table and view names: plural or set nouns (e.g. `actor_profile`, `concept_scheme`). Same attribute name for same meaning across schema.

## 2. DDL

- PRIMARY KEY at top of CREATE TABLE (first column or first in list). Every constraint must have a name (CONSTRAINT name) for CHECK, UNIQUE, FK.
- Use standard data types only; avoid non-standard extensions. Every table must have a key (natural or surrogate); do not expose physical locators as logical keys.

## 3. DML

- Use standard ANSI JOIN (LEFT JOIN … ON, RIGHT JOIN … ON); no comma-style joins.
- Prefer joins or non-correlated subqueries over correlated subqueries. Prefer declarative referential integrity (DRI) over triggers.

## 4. VIEW

- View names: same rules as tables (plural/set noun); no `vw_` prefix. CREATE VIEW must list column names explicitly.

## 5. Procedures and scripts

- Avoid dynamic SQL; if used, prevent SQL injection. Prefer set-based operations over cursors.

---

When in doubt or for typography, defaults, and exceptions, see RULESET.md §U.
